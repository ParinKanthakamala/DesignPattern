![img](assets/visitor/visitor.png)

# Visitor
Represent an operation to be performed on the elements of an object structure. Visitor lets you define a new operation without changing the classes of the elements on which it operates.

## üéØ ‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á pattern ‡∏ô‡∏µ‡πâ
‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏´‡∏°‡πà‡πÜ‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö class ‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°

## ‚úå ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏ö‡∏ö‡∏™‡∏±‡πâ‡∏ô‡πÜ
1. ‡∏™‡∏£‡πâ‡∏≤‡∏á Visitor interface ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏´‡∏°‡πà
1. ‡πÉ‡∏´‡πâ Class ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏±‡πâ‡∏ô‡∏¢‡∏±‡∏á‡πÑ‡∏á
1. ‡∏™‡∏£‡πâ‡∏≤‡∏á Concrete visitor ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏´‡πâ class ‡πÄ‡∏î‡∏¥‡∏°

## üò¢ ‡∏õ‡∏±‡∏ç‡∏´‡∏≤
‡∏´‡∏•‡∏±‡∏Å‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡∏£‡∏ö‡πÄ‡∏£‡πâ‡∏≤‡∏Ç‡∏≠‡∏á **‡∏°‡∏≤‡∏£‡πå‡∏Ñ‡∏™‡∏≤‡∏Å‡∏Å‡∏£‡∏∞‡πÄ‡∏ö‡∏∑‡∏≠** ‡πÑ‡∏°‡πà‡πÑ‡∏´‡∏ß ‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÄ‡∏£‡∏≤‡∏Å‡πá‡πÉ‡∏à‡∏≠‡πà‡∏≠‡∏ô‡∏¢‡∏≠‡∏°‡∏°‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ö **Google Map** ‡∏ã‡∏∂‡πà‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏î‡∏µ‡∏ß‡πà‡∏≤‡∏ï‡∏±‡∏ß Google map ‡∏ô‡∏±‡πâ‡∏ô‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏≠‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏£ ‡∏°‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏£‡∏∑‡∏≠‡∏ô ‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏° ‡∏™‡∏¥‡πà‡∏á‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡πà‡∏≤‡∏á‡πÜ‡∏≠‡∏µ‡∏Å‡∏ö‡∏≤‡∏ô‡∏ï‡∏∞‡πÑ‡∏ó ‡∏ã‡∏∂‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≤‡∏á‡πÜ‡∏ó‡∏µ‡πà‡∏ß‡πà‡∏≤‡∏°‡∏≤‡∏°‡∏±‡∏ô‡∏Å‡πá‡∏à‡∏∞‡∏°‡∏µ class ‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡πÄ‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÅ‡∏ö‡∏ö‡∏ó‡∏µ‡πà‡∏î‡∏π‡πÅ‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà ‡πÇ‡∏î‡∏¢‡∏Ç‡∏≠‡∏á‡∏û‡∏ß‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏°‡∏±‡∏ô‡∏ß‡πà‡∏≤ **Node**

‡∏≠‡∏¢‡∏π‡πà‡∏°‡∏≤‡∏ß‡∏±‡∏ô‡∏ô‡∏∂‡∏á ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡∏°‡∏≤‡∏ô‡∏±‡πà‡∏ô‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£ export ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô **XML** ‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏±‡πà‡∏ô‡πÄ‡∏≠‡∏á ‡∏ï‡∏≤‡∏°‡∏£‡∏π‡∏õ‡πÄ‡∏ö‡∏¢

![img](assets/visitor/problem1.png)

‡∏ü‡∏±‡∏á‡∏î‡∏π‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏∞‡πÑ‡∏£‡∏¢‡∏≤‡∏Å‡∏ô‡∏¥ ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏à‡∏∏‡∏î ‡∏Å‡πá‡∏°‡∏µ class ‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡πÄ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏≤‡∏Å‡πá‡πÅ‡∏Ñ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏° Export method ‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö class ‡∏û‡∏ß‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡πá‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏¥!!

‡πÅ‡∏ï‡πà‡πÅ‡∏•‡πâ‡∏ß **‡∏Ç‡∏á‡πÄ‡∏ö‡πâ‡∏á** ‡∏ó‡∏µ‡πà‡∏î‡∏π‡πÅ‡∏• system architect ‡∏≠‡∏¢‡∏π‡πà ‡∏Å‡πá‡πÑ‡∏°‡πà‡∏¢‡∏≠‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ô‡∏±‡πâ‡∏ô ‡πÇ‡∏î‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏ï‡∏∏‡∏ú‡∏•‡∏ß‡πà‡∏≤‡πÇ‡∏Ñ‡πâ‡∏î‡∏û‡∏ß‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô production ‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏≤‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡πÅ‡∏Å‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Å‡∏•‡∏±‡∏ß‡∏ß‡πà‡∏≤‡πÇ‡∏Ñ‡πâ‡∏î‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏°‡∏µ bug ‡∏Å‡πá‡πÑ‡∏î‡πâ (‡πÄ‡∏£‡∏≤‡∏ó‡∏≥ TDD ‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏∞‡πÄ‡∏ü‡∏£‡πâ‡∏¢)

> **Production**  
‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£‡∏Å‡πá‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏ï‡πà‡∏ó‡∏µ‡πà‡∏°‡∏±‡∏ô‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏£‡∏¥‡∏á‡πÜ ‡∏°‡∏µ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏£‡∏¥‡∏á ‡∏≠‡∏∞‡πÑ‡∏£‡∏û‡∏ß‡∏Å‡∏ô‡∏µ‡πâ ‡∏ã‡∏∂‡πà‡∏á‡∏Ç‡∏≠‡∏á‡∏û‡∏ß‡∏Å‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÑ‡∏õ‡∏¢‡∏∏‡πà‡∏á‡∏Å‡∏±‡∏ö‡∏°‡∏±‡∏ô‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏°‡∏±‡∏ô‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏≤‡πÄ‡∏•‡∏¢‡∏à‡∏∞‡∏ó‡∏≥ `Staging environment` ‡πÅ‡∏•‡∏∞ `Development environment` ‡πÄ‡∏≠‡∏≤‡πÑ‡∏ß‡πâ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ó‡∏î‡∏™‡∏≠‡∏ö feature ‡πÉ‡∏´‡∏°‡πà‡πÜ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà `Production environment` ‡∏ô‡∏±‡πà‡∏ô‡πÄ‡∏≠‡∏á

> **TDD - Test Driven Development**  
‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ã‡∏≠‡∏ü‡∏ï‡πå‡πÅ‡∏ß‡∏£‡πå‡πÇ‡∏î‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô test ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏™‡∏°‡∏≠ [‡πÑ‡∏õ‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡πà VDO ‡∏Ç‡∏≠‡∏á‡∏ú‡∏°‡πÄ‡∏≠‡∏≤‡∏•‡∏∞‡∏Å‡∏±‡∏ô ‡∏Å‡∏î‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢](https://www.youtube.com/watch?v=k8pnhUebGTg&list=PLUjAn8nwWniiL3ToFK8PfmAo8U6IoGAkg)

![img](assets/visitor/problem2-en.png)

‡∏ô‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏õ‡πã‡∏≤‡πÅ‡∏Å‡∏à‡∏∞‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡πÑ‡∏°‡πà‡∏¢‡∏≠‡∏°‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡πÅ‡∏Å‡πâ class ‡∏û‡∏ß‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡∏õ‡πã‡∏≤‡πÅ‡∏Å‡∏¢‡∏±‡∏á‡∏ï‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏ß‡πà‡∏≤

‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á class ‡∏û‡∏ß‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏ô‡∏∞‡πÄ‡∏ü‡∏£‡πâ‡∏¢ ‡πÄ‡∏≠‡πá‡∏á‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏°‡∏±‡∏ô‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏´‡∏£‡∏≠‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏° Export method ‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö class ‡∏û‡∏ß‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏ô‡∏∞? (‡∏û‡∏≤‡∏ï‡∏≤‡∏°‡πà‡∏≠‡∏ô!! ‡∏°‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÅ‡∏Ñ‡πà‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á production ‡πÅ‡∏•‡πâ‡∏ß ‡∏°‡∏±‡∏ô‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á design ‡∏î‡πâ‡∏ß‡∏¢)

‡∏ó‡∏µ‡πà‡πÄ‡∏à‡πã‡∏á‡πÑ‡∏õ‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏Ñ‡∏∑‡∏≠ ‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏¢‡∏¥‡∏ô‡∏Ç‡πà‡∏≤‡∏ß‡∏°‡∏≤‡∏ß‡πà‡∏≤‡πÄ‡∏Æ‡∏µ‡∏¢ **‡∏°‡∏≤‡∏£‡πå‡∏Ñ‡∏™‡∏≤‡∏Å‡∏Å‡∏£‡∏∞‡πÄ‡∏ö‡∏∑‡∏≠** ‡∏¢‡∏±‡∏á‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤ export ‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏≤‡∏¢‡πÜ format ‡πÅ‡∏•‡∏∞‡∏¢‡∏±‡∏á‡∏°‡∏µ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÅ‡∏õ‡∏•‡∏Å‡πÜ‡∏≠‡∏µ‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡πÜ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏≤‡∏Å‡∏à‡∏∞‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏≠‡∏µ‡∏Å‡∏î‡πâ‡∏ß‡∏¢ ‡∏ã‡∏∂‡πà‡∏á‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏¥‡∏î‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏ï‡∏≠‡∏ô‡πÅ‡∏£‡∏Å ‡∏°‡∏±‡∏ô‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ class ‡∏û‡∏ß‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏¢‡∏±‡∏î‡∏Ç‡∏≠‡∏á‡πÅ‡∏õ‡∏•‡∏Å‡πÜ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏∏‡∏Å‡πÜ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏•‡∏¢‡∏≠‡∏∞‡∏î‡∏¥ ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏û‡∏ß‡∏Å‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏î‡∏µ‡∏Å‡∏±‡∏ô‡∏ô‡∏∞ ??

## üòÑ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏¥‡∏ô‡∏Ñ‡∏¥‡∏î‡∏´‡∏≤‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏≠‡∏¢‡∏π‡πà‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡πá‡πÑ‡∏î‡πâ‡∏û‡∏ö‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡∏∏‡πà‡∏°‡πÉ‡∏™‡πà‡∏´‡∏°‡∏ß‡∏Å‡∏ü‡∏≤‡∏á‡∏¢‡∏∑‡∏ô‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡∏Å‡∏ß‡∏≤‡∏á‡πÄ‡∏£‡∏ô‡πÄ‡∏î‡∏µ‡∏¢‡∏™‡∏ß‡∏°‡∏´‡∏°‡∏ß‡∏Å‡∏≠‡∏¢‡∏π‡πà ‡πÄ‡∏•‡∏¢‡πÑ‡∏î‡πâ‡∏¢‡∏¥‡∏ô‡∏ö‡∏ó‡∏™‡∏ô‡∏ò‡∏ô‡∏≤‡∏ß‡πà‡∏≤

**‡∏Å‡∏ß‡∏≤‡∏á‡πÄ‡∏£‡∏ô‡πÄ‡∏î‡∏µ‡∏¢**: ‡∏ñ‡πâ‡∏≤‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÜ‡∏°‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢‡πÜ‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏∞‡∏Å‡πá ‡∏à‡∏á‡πÉ‡∏ä‡πâ `Visitor pattern` ‡∏î‡∏¥‡∏ß‡∏∞‡πÄ‡∏à‡πâ‡∏≤**‡∏•‡∏π‡∏ü‡∏µ‡πà**!! (‡∏≠‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏°‡∏ß‡∏Å‡∏ü‡∏≤‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏ü‡∏µ‡πà‡∏ô‡∏µ‡πà‡πÄ‡∏≠‡∏á) ‡πÄ‡∏à‡πâ‡∏≤ visitor pattern ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏£‡∏≤‡∏ß‡πà‡∏≤ ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤ ‡∏à‡∏á‡πÅ‡∏¢‡∏Å‡∏á‡∏≤‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô class ‡πÉ‡∏´‡∏°‡πà ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏à‡πâ‡∏≤ class ‡∏ô‡∏±‡πâ‡∏ô‡∏ß‡πà‡∏≤ `Visitor` ‡πÑ‡∏á  

**‡∏•‡∏π‡∏ü‡∏µ‡πà**: ‡∏≠‡πã‡∏≠‡∏Ñ‡∏∏‡πâ‡∏ô‡πÜ‡∏•‡∏∞ ‡∏ñ‡πâ‡∏≤‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ô‡∏±‡πâ‡∏ô‡∏°‡∏±‡∏ô‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏õ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç class ‡πÄ‡∏î‡∏¥‡∏°‡πÄ‡∏•‡∏¢‡∏≠‡∏∞‡∏î‡∏¥ ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏≤‡∏Å‡πá‡πÄ‡∏£‡∏µ‡∏¢‡∏Å class ‡πÄ‡∏î‡∏¥‡∏°‡∏û‡∏ß‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏ß‡πà‡∏≤ `Element` ‡πÉ‡∏ä‡πà‡∏õ‡∏∞ **‡∏ä‡πá‡∏≠‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå** (‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏à‡πâ‡∏≤‡∏Å‡∏ß‡∏≤‡∏á‡∏ô‡∏±‡πâ‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡πá‡∏≠‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πà‡πÄ‡∏≠‡∏á)  

**‡∏ä‡πá‡∏≠‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå**: ‡πÉ‡∏ä‡πà‡πÄ‡∏•‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏¢‡∏≤‡∏Å ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏à‡πâ‡∏≤ visitor ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏à‡∏∞‡∏°‡∏µ method ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö class ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏´‡∏°‡πà‡πÜ‡πÉ‡∏´‡πâ‡∏°‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏î‡πâ‡∏ß‡∏¢ ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏à‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏´‡∏°‡πà‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡∏†‡∏≤‡∏¢‡πÉ‡∏ô method ‡∏ô‡∏µ‡πâ‡πÄ‡∏•‡∏¢ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ñ‡∏π‡∏Å‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡πÅ‡∏ï‡πà‡∏Å‡πá‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏´‡∏°‡πà‡πÜ‡∏î‡πâ‡∏ß‡∏¢‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏•‡∏∞

(‡πÄ‡∏£‡∏≤‡∏Ñ‡∏¥‡∏î‡πÉ‡∏ô‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤) ‡∏≠‡∏∑‡∏°‡∏°‡∏°‡∏° ‡∏ü‡∏±‡∏á‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏≠‡πÄ‡∏î‡∏µ‡∏¢‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ô‡∏¥‡∏ô‡πà‡∏≤ ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡∏°‡∏±‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö class ‡∏´‡∏•‡∏≤‡∏¢‡πÜ‡πÅ‡∏ö‡∏ö‡∏•‡∏∞? ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÉ‡∏ô‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏°‡∏µ class ‡∏ï‡∏±‡πâ‡∏á‡∏´‡∏•‡∏≤‡∏¢‡∏ï‡∏±‡∏ß ‡πÄ‡∏ä‡πà‡∏ô ‡∏°‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏£‡∏∑‡∏≠‡∏ô ‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏° ‡∏ö‡∏•‡∏≤‡πÜ ‡∏ô‡∏¥‡πÄ‡∏•‡∏¢‡∏´‡∏ß‡πà‡∏≤

‡πÄ‡∏≠‡πá‡∏á‡∏Å‡πá‡∏™‡∏£‡πâ‡∏≤‡∏á method ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö class ‡∏ó‡∏∏‡∏Å‡πÅ‡∏ö‡∏ö‡∏ô‡∏±‡πà‡∏ô‡∏î‡∏¥‡∏ß‡∏∞!!

(‡πÄ‡∏™‡∏µ‡∏¢‡∏á **‡∏ä‡πá‡∏≠‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå** ‡∏ï‡∏∞‡πÇ‡∏Å‡∏ô‡πÉ‡∏™‡πà **‡∏•‡∏π‡∏ü‡∏µ‡πà** ‡∏î‡∏±‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤ ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤‡πÅ‡∏ï‡πà‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏î)

‡∏õ‡∏¥‡πä‡∏á!! ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ï‡∏£‡∏±‡∏™‡∏£‡∏π‡πâ‡πÉ‡∏ô‡∏ó‡πà‡∏≤‡πÅ‡∏≠‡∏ö‡∏ü‡∏±‡∏á‡∏ä‡∏≤‡∏ß‡∏ö‡πâ‡∏≤‡∏ô ‡∏à‡∏∂‡∏á‡πÄ‡∏´‡πá‡∏ô‡∏ô‡∏¥‡∏°‡∏¥‡∏ï‡∏£‡∏•‡∏≠‡∏¢‡∏°‡∏≤‡∏Å‡∏•‡∏≤‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏ï‡∏≤‡∏°‡πÇ‡∏Ñ‡πâ‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏•‡∏¢

```
class XMLExportVisitor
{
    method DoForCity(City c) { ... }
    method DoForIndustry(Industry f) { ... }
    method DoForSightSeeing(SightSeeing ss) { ... }
}
```

‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏Ç‡∏≠‡∏á‡∏û‡∏ß‡∏Å‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏ü‡∏£‡∏∞ ‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≤‡∏ô‡∏±‡πà‡∏á‡πÑ‡∏•‡πà‡πÄ‡∏ä‡πá‡∏Ñ‡πÅ‡∏ö‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡∏Å‡πá‡∏¢‡∏≤‡∏Å‡∏ï‡∏≤‡∏¢‡∏û‡∏≠‡∏î‡∏µ‡∏î‡∏¥

```
foreach (Node node in nodeCollection)
    if (node is City) exportVisitor.DoForCity((City) node)
    if (node is Industry) exportVisitor.DoForIndustry((Industry) node)
    // ...
}
```

‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô method overloading ‡∏î‡∏µ‡∏´‡∏ß‡πà‡∏≤ ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡∏Ç‡∏∑‡∏ô‡∏ó‡∏≥‡πÑ‡∏õ‡∏ô‡∏±‡πà‡∏ô‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤ ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏™‡∏¥‡πà‡∏á‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡πÜ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤ ‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏õ‡πÑ‡∏•‡πà‡πÅ‡∏Å‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏£‡∏≤‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏≠‡∏∞‡∏î‡∏¥!!

‡∏û‡∏≠‡πÑ‡∏î‡πâ‡∏™‡∏ï‡∏¥‡∏ß‡πà‡∏≤‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‡πÄ‡∏•‡∏¢‡∏°‡∏≠‡∏á‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÄ‡∏à‡πâ‡∏≤ 2 ‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡πà‡∏ô‡∏ï‡πà‡∏≠

**‡∏ä‡πá‡∏≠‡∏õ‡πÄ‡∏õ‡∏≠‡∏£‡πå**: ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡∏Ñ‡∏¥‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏µ‡πâ‡∏≠‡∏∞ Visitor pattern ‡πÄ‡∏Ç‡∏≤‡∏°‡∏µ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÑ‡∏ß‡πâ‡πÅ‡∏•‡πâ‡∏ß‡πÇ‡∏ß‡πâ‡∏¢ ‡∏°‡∏±‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤ `Double Dispatch` ‡∏¢‡∏±‡∏á‡πÑ‡∏á‡∏•‡∏∞!! (NaNi?) ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏°‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠ `‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÑ‡∏õ‡πÑ‡∏•‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤ object ‡∏ô‡∏±‡πâ‡∏ô‡∏Ñ‡∏ß‡∏£‡∏à‡∏∞‡πÉ‡∏ä‡πâ method ‡∏ï‡∏±‡∏ß‡πÑ‡∏´‡∏ô‡∏î‡∏µ` ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏≤‡∏ô‡∏Å‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠ `object ‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡πâ‡∏ô‡πÅ‡∏´‡∏•‡∏∞‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤ visitor ‡πÑ‡∏´‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏Å‡∏±‡∏ö‡∏°‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏≠‡πÄ‡∏à‡πâ‡∏≤ object ‡∏ô‡∏±‡πà‡∏ô‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏ö‡∏≠‡∏Å‡∏≠‡∏µ‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏ß‡πà‡∏≤ method ‡πÑ‡∏´‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏±‡∏ô‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢`

‡∏ô‡∏¥‡∏°‡∏¥‡∏ï‡∏£‡∏•‡∏≠‡∏¢‡∏°‡∏≤‡∏Å‡∏•‡∏≤‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á

```
// Client code
foreach (Node node in graph)
    node.Accept(exportVisitor)

// City
class City
{
    void Accept(Visitor v)
        => v.DoForCity(this);
}

// Industry
class Industry
{
    void accept(Visitor v)
        => v.DoForIndustry(this);
}
```

‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏Å‡πá‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ class ‡∏≠‡∏¢‡∏π‡πà‡∏î‡∏µ‡∏ô‡∏¥‡∏´‡∏ß‡πà‡∏≤ ‡πÅ‡∏ï‡πà‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏°‡∏±‡∏ô‡∏Å‡πá‡πÅ‡∏Å‡πâ‡πÅ‡∏Ñ‡πà‡∏ô‡∏¥‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‡πÅ‡∏•‡∏∞‡∏°‡∏±‡∏ô‡∏¢‡∏±‡∏á‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏´‡∏°‡πà‡πÜ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏õ‡πÅ‡∏Å‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏∞

‡∏≠‡∏≤‡∏ß‡∏•‡∏∞ ‡∏•‡∏≠‡∏á‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö Interface ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏ß‡∏Å visitor ‡∏î‡∏π ‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏õ‡∏Ñ‡∏∏‡∏¢‡∏Å‡∏±‡∏ö‡∏õ‡πã‡∏≤‡∏Ç‡∏á‡πÄ‡∏ö‡πâ‡∏á‡∏≠‡∏µ‡∏Å‡∏ó‡∏µ‡∏•‡∏∞‡∏Å‡∏±‡∏ô ‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏∞‡∏•‡∏≠‡∏á‡∏°‡∏≤‡∏ü‡∏±‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏ß‡∏¢‡∏î‡∏π‡∏ö‡πâ‡∏≤‡∏á‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤ ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏™‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏ô‡∏±‡πà‡∏ô‡∏à‡∏∞‡πÉ‡∏ö‡πâ‡∏≠‡∏∞‡πÑ‡∏£‡πÅ‡∏°‡πà‡∏ô‡πÜ‡πÉ‡∏´‡πâ‡∏ü‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏á

‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∑‡∏≠ ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏´‡∏°‡πà‡πÜ‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏•‡∏∞

## üìå ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏≠‡∏á pattern ‡∏ô‡∏µ‡πâ
![img](assets/visitor/structure-indexed.png)

> **‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢**  
**1.Visitor** - ‡πÄ‡∏õ‡πá‡∏ô interface ‡∏Å‡∏•‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏ß‡∏Å visitor ‡πÇ‡∏î‡∏¢‡∏°‡∏µ method ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö class ‡∏ï‡πà‡∏≤‡∏á‡πÜ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏£‡∏ñ‡πÉ‡∏´‡πâ  
**2.Concrete Visitor** - ‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏î‡∏π‡πÅ‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÜ‡∏Ç‡∏≠‡∏á class ‡∏ï‡πà‡∏≤‡∏á‡πÜ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏£‡∏ñ‡πÉ‡∏´‡πâ  
**3.Element** - ‡πÄ‡∏õ‡πá‡∏ô interface ‡∏Å‡∏•‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö class ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏°‡∏±‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏´‡∏°‡πà‡πÜ‡πÑ‡∏î‡πâ ‡πÇ‡∏î‡∏¢‡∏ï‡∏±‡∏ß‡∏°‡∏±‡∏ô‡∏à‡∏∞‡∏°‡∏µ accept method ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏•‡∏∑‡∏≠‡∏Å visitor ‡∏ó‡∏µ‡πà‡∏°‡∏±‡∏ô‡∏à‡∏∞‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢  
**4.Concrete Element** - ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ö visitor ‡∏ï‡∏±‡∏ß‡πÑ‡∏´‡∏ô ‡πÇ‡∏î‡∏¢‡∏ï‡∏±‡∏ß‡∏°‡∏±‡∏ô‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å method ‡∏Ç‡∏≠‡∏á visitor ‡∏ó‡∏µ‡πà‡∏°‡∏±‡∏ô‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏µ‡∏Å‡∏î‡πâ‡∏ß‡∏¢  
**5.Client** - ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏™‡πà‡∏á visitor ‡πÑ‡∏õ‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö element ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏î‡πâ‡∏ß‡∏¢

## üõ† ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏ó‡∏£‡∏á‡∏´‡∏•‡∏≤‡∏¢‡πÜ‡πÅ‡∏ö‡∏ö ‡∏à‡∏∏‡∏î, ‡∏ß‡∏á‡∏Å‡∏•‡∏°, ‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏° ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡∏à‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏´‡πâ‡∏°‡∏±‡∏ô 2 ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏∑‡∏≠
1. ‡πÉ‡∏´‡πâ‡∏°‡∏±‡∏ô export ‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå XML ‡πÑ‡∏î‡πâ
1. ‡πÉ‡∏´‡πâ‡∏°‡∏±‡∏ô export ‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå Json ‡πÑ‡∏î‡πâ
‡πÇ‡∏î‡∏¢‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ Visitor pattern ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏ä‡πà‡∏ß‡∏¢ ‡∏õ‡∏∞‡πÑ‡∏õ‡∏•‡∏≠‡∏á‡∏î‡∏π‡πÇ‡∏Ñ‡πâ‡∏î‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô

## üëç ‡∏Ç‡πâ‡∏≠‡∏î‡∏µ
* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏´‡∏°‡πà‡πÜ‡πÉ‡∏´‡πâ‡∏Å‡∏±‡∏ö class ‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡∏°‡∏µ‡πÑ‡∏ß‡πâ‡πÑ‡∏î‡πâ ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏õ‡∏¢‡∏∏‡πà‡∏á‡∏Å‡∏±‡∏ö‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏°
* ‡∏ñ‡∏π‡∏Å‡∏´‡∏•‡∏±‡∏Å `Open/Closed Principle`
* ‡∏ñ‡∏π‡∏Å‡∏´‡∏•‡∏±‡∏Å `Single Responsibility Principle`

## üëé ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏µ‡∏¢
* ‡∏ñ‡πâ‡∏≤ class ‡∏ñ‡∏π‡∏Å‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç,‡πÄ‡∏û‡∏¥‡πà‡∏°,‡∏•‡∏ö ‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç visitor ‡∏î‡πâ‡∏ß‡∏¢
* ‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏≠‡∏¢‡∏°‡∏≤‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ visitor ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô private/protected

## ‚Äç‚Äçüìù Code ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
```
using System;
using System.Collections.Generic;

// Element Interface
interface IShape
{
    void Accept(IExporter exporter);
}

// Concrete Elements
class Dot : IShape
{
    public int X { get; set; }
    public int Y { get; set; }

    public void Accept(IExporter visitor)
        => visitor.Visit(this);
}
class Circle : IShape
{
    public int Radius { get; set; }

    public void Accept(IExporter visitor)
        => visitor.Visit(this);
}
class Rectangle : IShape
{
    public int Hight { get; set; }
    public int Width { get; set; }

    public void Accept(IExporter visitor)
        => visitor.Visit(this);
}

// Visitor Interface
interface IExporter
{
    void Visit(Dot shape);
    void Visit(Circle shape);
    void Visit(Rectangle shape);
}

// Concrete Visitors
class XMLExporter : IExporter
{
    public void Visit(Dot shape)
        => Console.WriteLine($"<shape><type>‡∏à‡∏∏‡∏î</type><X>{shape.X}</X><Y>{shape.Y}</Y></shape>");

    public void Visit(Circle shape)
        => Console.WriteLine($"<shape><type>‡∏ß‡∏á‡∏Å‡∏•‡∏°</type><area>{Math.PI * shape.Radius * shape.Radius}</area></shape>");

    public void Visit(Rectangle shape)
        => Console.WriteLine($"<shape><type>‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°</type><area>{shape.Width * shape.Hight}</area></shape>");
}
class JsonExporter : IExporter
{
    public void Visit(Dot shape)
        => Console.WriteLine($"{{ \"type\": \"‡∏à‡∏∏‡∏î\", \"X\": {shape.X}, \"Y\": {shape.Y} }}");

    public void Visit(Circle shape)
        => Console.WriteLine($"{{ \"type\": \"‡∏ß‡∏á‡∏Å‡∏•‡∏°\", \"area\": {Math.PI * shape.Radius * shape.Radius} }}");

    public void Visit(Rectangle shape)
        => Console.WriteLine($"{{ \"type\": \"‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°\", \"area\": {shape.Width * shape.Hight} }}");
}

class Program
{
    static void Main()
    {
        var shapes = new List<IShape>
        {
            new Dot{ X = 5, Y = 10 },
            new Circle{ Radius = 5 },
            new Rectangle{ Width = 10, Hight = 20},
        };

        Console.WriteLine("Export to XML");
        var xmlExporter = new XMLExporter();
        foreach(var element in shapes)
        {
            element.Accept(xmlExporter);
        }

        Console.WriteLine();

        Console.WriteLine("Export to Json");
        var htmlExporter = new JsonExporter();
        foreach(var element in shapes)
        {
            element.Accept(htmlExporter);
        }
    }
}
```

**Output**
```
Export to XML
<shape><type>‡∏à‡∏∏‡∏î</type><X>5</X><Y>10</Y></shape>
<shape><type>‡∏ß‡∏á‡∏Å‡∏•‡∏°</type><area>78.5398163397448</area></shape>
<shape><type>‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°</type><area>200</area></shape>

Export to Json
{ "type": "‡∏à‡∏∏‡∏î", "X": 5, "Y": 10 }
{ "type": "‡∏ß‡∏á‡∏Å‡∏•‡∏°", "area": 78.5398163397448 }
{ "type": "‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°", "area": 200 }
```

# Credit
https://refactoring.guru  
You can buy his book by click the image below.  
[![img](https://refactoring.guru/images/patterns/book/web-cover-en.png)](https://refactoring.guru/design-patterns/book#buy-now)  